# HMI 프로그램 용량 분석 및 배포 가이드

## 📊 현재 프로젝트 용량 분석

### 전체 용량: 약 124MB

| 구분 | 용량 | 비율 |
|------|------|------|
| Frontend | 88MB | 71% |
| Backend | 37MB | 30% |
| 기타 (문서, 설정) | ~1MB | <1% |

### 상세 분석

#### Frontend (88MB)
```
frontend/
├── node_modules/           87MB  ← 개발 의존성
│   ├── lucide-react       26MB
│   ├── @babel             11MB
│   ├── @esbuild           9.5MB
│   ├── recharts           5.2MB
│   └── 기타               35.3MB
├── node_modules/.vite/     2.8MB ← 개발 캐시
├── dist/                   325KB ← 빌드 결과물 (실제 배포 파일)
└── src/                    ~100KB ← 소스코드
```

#### Backend (37MB)
```
backend/
├── venv/                   37MB  ← Python 가상환경
│   ├── Lib/               35MB
│   │   └── site-packages/
│   │       ├── pip        13MB
│   │       ├── pydantic   9.6MB
│   │       ├── pymodbus   1.6MB
│   │       ├── fastapi    1.4MB
│   │       ├── websockets 1.5MB
│   │       └── 기타       8.9MB
│   └── Scripts/           1.7MB
├── main.py                 12KB  ← 실제 코드
├── modbus_client.py        21KB  ← 실제 코드
├── requirements.txt        96B   ← 의존성 목록
└── __pycache__/            44KB  ← 캐시 (삭제 가능)
```

---

## 🎯 개발 환경 vs 배포 환경

### 개발 시 필요한 파일

| 항목 | 용량 | 용도 |
|------|------|------|
| `frontend/node_modules/` | 87MB | Vite, Babel 등 빌드 도구 |
| `frontend/src/` | ~100KB | React 소스코드 |
| `backend/venv/` | 37MB | Python 런타임 라이브러리 |
| `backend/*.py` | 33KB | Python 소스코드 |
| 문서 파일들 | ~100KB | 개발 참고 문서 |

### HMI 배포 시 필요한 파일

| 항목 | 용량 | 필수 여부 | 설명 |
|------|------|-----------|------|
| `frontend/dist/` | 325KB | ✅ 필수 | 빌드된 웹 인터페이스 |
| `backend/main.py` | 12KB | ✅ 필수 | FastAPI 서버 |
| `backend/modbus_client.py` | 21KB | ✅ 필수 | Modbus 통신 |
| `backend/requirements.txt` | 96B | ✅ 필수 | 의존성 목록 |
| `backend/venv/` | 37MB | ⚠️ 조건부 | 옵션1: 포함 / 옵션2: 현장 설치 |
| `frontend/node_modules/` | 87MB | ❌ 불필요 | 빌드 후 불필요 |
| `frontend/src/` | ~100KB | ❌ 불필요 | dist로 빌드됨 |

---

## 📦 HMI 배포 방법

### 옵션 1: venv 포함 배포 (권장 - 간편함)

#### 장점
- HMI에 업로드 후 즉시 실행 가능
- 인터넷 연결 불필요
- 의존성 버전 고정

#### 배포 파일 구조
```
HMI_REAL/
├── frontend/
│   └── dist/              (325KB)
│       ├── index.html
│       └── assets/
├── backend/
│   ├── main.py            (12KB)
│   ├── modbus_client.py   (21KB)
│   ├── requirements.txt   (96B)
│   └── venv/              (37MB)  ← 포함
├── START_HMI.bat
├── START_BACKEND.bat
├── START_FRONTEND.bat
└── STOP_HMI.bat

총 배포 용량: 약 38MB
```

#### 배포 절차
1. 개발 PC에서 프로젝트 빌드
   ```bash
   cd frontend
   npm run build
   ```

2. 불필요한 파일 제거
   - `frontend/node_modules/` 삭제
   - `frontend/src/` 삭제 (백업 보관)
   - `backend/__pycache__/` 삭제
   - 중복 문서 파일 정리

3. HMI에 업로드
   - 위 파일 구조 그대로 복사

4. HMI에서 실행
   ```bash
   START_HMI.bat
   ```

---

### 옵션 2: venv 제외 배포 (용량 최소화)

#### 장점
- 업로드 용량 최소화 (350KB)
- 네트워크 전송 시간 단축

#### 단점
- HMI에 인터넷 연결 필요
- 초기 설치 시간 소요 (~5-10분)
- Python이 HMI에 설치되어 있어야 함

#### 배포 파일 구조
```
HMI_REAL/
├── frontend/
│   └── dist/              (325KB)
├── backend/
│   ├── main.py            (12KB)
│   ├── modbus_client.py   (21KB)
│   └── requirements.txt   (96B)  ← venv 제외
├── START_HMI.bat
└── INSTALL_DEPENDENCIES.bat  ← 의존성 설치 스크립트

총 배포 용량: 약 350KB
```

#### 배포 절차
1. 개발 PC에서 최소 파일만 준비
   ```bash
   cd frontend
   npm run build
   ```

2. HMI에 업로드 (venv 제외)

3. HMI에서 의존성 설치
   ```bash
   cd backend
   python -m venv venv
   venv\Scripts\activate
   pip install -r requirements.txt
   ```

4. 실행
   ```bash
   START_HMI.bat
   ```

---

## 🗑️ 삭제 가능한 파일 (개발 환경 정리)

### 즉시 삭제 가능

#### 캐시 파일
- `backend/__pycache__/` (44KB)
- `backend/nul`
- `frontend/nul`
- `frontend/node_modules/.vite/` (2.8MB)

#### 개발 의존성 (필요시 재생성 가능)
- `frontend/node_modules/` (87MB)
  - 재생성: `npm install`
- `backend/venv/` (37MB)
  - 재생성: `python -m venv venv` + `pip install -r requirements.txt`

### 문서 파일 정리 권장

현재 중복/유사한 문서 11개 존재:

```
현재 문서 파일들:
├── README.md                    ← 통합 권장
├── 사용_가이드.md               ← 중복
├── 사용_방법.md                 ← 중복
├── 사용자_가이드.md             ← 중복
├── 빠른_실행_가이드.md          ← 중복
├── 시뮬레이터_사용_가이드.md
├── HMI_배포_가이드.md
├── 테스트_가이드.md
├── 전체_구현_완료.md            ← 개발 완료 후 삭제 가능
├── 완료_보고서.md               ← 개발 완료 후 삭제 가능
└── FAN_DIAGRAM_설정_가이드.md

권장 구조:
├── README.md                    ← 프로젝트 개요 + 빠른 시작
├── 사용자_가이드.md             ← 운영 매뉴얼 통합
├── 배포_가이드.md               ← 이 문서 통합
└── 개발_참고/                   ← 기술 문서 보관
    ├── 시뮬레이터_가이드.md
    ├── FAN_DIAGRAM_설정.md
    └── 테스트_가이드.md
```

---

## 📋 .gitignore 파일 설정 권장

개발 환경 파일을 Git에서 제외하기 위한 설정:

```gitignore
# Python
backend/venv/
backend/__pycache__/
*.pyc
*.pyo
*.pyd
.Python
*.so
*.egg
*.egg-info/
dist/
build/

# Node.js
frontend/node_modules/
frontend/dist/
frontend/.vite/
*.log
npm-debug.log*

# 임시 파일
nul
*.tmp
*.temp

# OS
.DS_Store
Thumbs.db
desktop.ini

# IDE
.vscode/
.idea/
*.swp
*.swo
```

---

## ⚡ 용량 최적화 체크리스트

### 개발 중
- [ ] `.gitignore` 파일 생성
- [ ] 캐시 파일 정기적 삭제
- [ ] 중복 문서 통합
- [ ] 불필요한 의존성 제거

### 배포 전
- [ ] Frontend 빌드 수행 (`npm run build`)
- [ ] `node_modules/` 삭제 여부 결정
- [ ] `__pycache__/` 삭제
- [ ] `nul` 파일 삭제
- [ ] 문서 파일 정리

### 배포 옵션 선택
- [ ] 옵션 1: venv 포함 (38MB, 즉시 실행)
- [ ] 옵션 2: venv 제외 (350KB, 현장 설치)

---

## 💡 요약

### 현재 상태
- **전체 프로젝트**: 124MB
- **실제 소스코드**: 약 150KB
- **개발 의존성**: 124MB (node_modules + venv)

### 배포 시
- **옵션 1 (권장)**: 38MB (venv 포함)
- **옵션 2 (최소)**: 350KB (현장 설치)

### 핵심 포인트
1. `node_modules/` (87MB)는 빌드 후 **삭제 가능**
2. `backend/venv/` (37MB)는 실행 시 **필수** (또는 현장 재설치)
3. 실제 동작 파일은 `dist/` (325KB) + `backend/*.py` (33KB)
4. 배포 방법은 HMI 환경에 따라 선택

### 권장 사항
- **일반적인 경우**: 옵션 1 (venv 포함 배포)
- **네트워크 제한 환경**: 옵션 1 필수
- **업데이트 빈번**: 옵션 2 (소스만 빠르게 교체)
